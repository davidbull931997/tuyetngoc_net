var observer=new MutationObserver(function(a){a.forEach(function(a){"style"!=a.attributeName||"display: none !important;"==a.target.style.cssText||glob_submit||checkInput(glob_submit)})}),glob_submit=!1,wakeHerokuAppTimer;observer.observe(document.querySelector("div#manage-page"),{attributes:!0});992>$(window).width()&&$("div.loader-parent").css("display","none");
$(function(){if(992>$(window).width())swal({title:"Kh\u00f4ng t\u01b0\u01a1ng th\u00edch",type:"error",text:"\u1ee8ng d\u1ee5ng kh\u00f4ng ho\u1ea1t \u0111\u1ed9ng tr\u00ean thi\u1ebft b\u1ecb di \u0111\u1ed9ng",showConfirmButton:!1,showCloseButton:!1,showCancelButton:!1,allowOutsideClick:!1,allowEscapeKey:!1});else{setTimeout(function(){$("div.loader-parent").fadeOut(400,function(){$("div#login-page").css("display","")})},1500);swal.setDefaults({allowOutsideClick:!1,allowEscapeKey:!1});var a=new Date;
$("p.text-center.copy-right").append(a.getFullYear())}});$(window).resize(function(){});$(window).on("unload",function(){clearInterval(wakeHerokuAppTimer);observer.disconnect();"block"==$("div#manage-page").css("display")&&$.post({url:"/admin/adminUnLoad",async:!1})});$("a#login-btn").click(function(a){glob_submit=!0;checkInput(glob_submit);return!1});$("input#username").keypress(function(a){glob_submit=!0;13==a.keyCode&&checkInput(glob_submit)});
$("input#password").keypress(function(a){glob_submit=!0;13==a.keyCode&&checkInput(glob_submit)});$("#custom-search-input > div > span > button").click(function(){searchCustomer()});$("#custom-search-input > div > input").keypress(function(a){13==a.keyCode&&searchCustomer()});$("#add-new-btn").click(function(){addNewCustomer()});
function checkPlayTime1(){0>=parseInt($('#manage-page > div  > div.vex.vex-theme-wireframe > div.vex-content > form > div.vex-dialog-input > label > input[type="number"]:nth-child(2)').val())&&($('#manage-page > div > div.vex.vex-theme-wireframe > div.vex-content > form > div.vex-dialog-input > label > input[type="number"]:nth-child(2)').val(1),$('#manage-page > div > div.vex.vex-theme-wireframe > div.vex-content > form > div.vex-dialog-input > label > input[type="number"]:nth-child(2)').select())}
function searchCustomer(){for(i=0;i<vue.$data.customerList.length;i++)$("#custom-search-input > div > input").val().toLowerCase()==vue.$data.customerList[i].username.toLowerCase()&&($("body").animate({scrollTop:$("#"+vue.$data.customerList[i]._id).offset().top-$("#fixed-thead").height()}),setTimeout(function(a){$("#"+a).css({transition:"1s","background-color":"#5cd660"});setTimeout(function(a){$("#"+a).css({"background-color":""})},1001,a)},401,vue.$data.customerList[i]._id))}
function addNewCustomer(){var a=!1;for(i=1;i<=$("tbody#vue > tr").length;i++)if("inline-block"==$("tbody#vue > tr:nth-child("+i+") > td:nth-child(7) > a:first-child").css("display")){a=!0;break}a||vex.dialog.open({overlayClosesOnClick:!1,appendLocation:"#manage-page",message:"Th\u00eam m\u1edbi kh\u00e1ch h\u00e0ng:",input:'<label for><input name="customerName" type="text" placeholder="T\u00ean kh\u00e1ch h\u00e0ng" required /><input name="customerPoint" min=1 oninput="checkPlayTime1();" type="number" placeholder="\u0110i\u1ec3m" required /><label class="col-xs-4" style="font-weight:normal;">M\u1ed1c nh\u1eadn qu\u00e0:</label>\n\t\t\t<div class="col-xs-8">\n                <div class="pull-right">\n                    <input type="checkbox" name="customerReward30">\n                    <label for="customerReward30">30</label>\n                    <input type="checkbox" name="customerReward50">\n                    <label for="customerReward50">50</label>\n                    <input type="checkbox" name="customerReward70">\n                    <label for="customerReward70">70</label>\n                    <br>\n                    <input type="checkbox" name="customerReward80">\n                    <label for="customerReward80">80</label>\n                    <input type="checkbox" name="customerReward100">\n                    <label for="customerReward100">100</label>\n                    <input type="checkbox" name="customerReward111">\n                    <label for="customerReward111">111</label>\n                </div>\n\t\t\t</div>',
buttons:[$.extend({},vex.dialog.buttons.YES,{text:"Th\u00eam"}),$.extend({},vex.dialog.buttons.NO,{text:"H\u1ee7y"})],callback:function(a){if(a){var b=!1;for(i=0;i<vue.$data.customerList.length;i++)if(a.customerName==vue.$data.customerList[i].username){vex.dialog.alert({message:"T\u00ean kh\u00e1ch h\u00e0ng \u0111\u00e3 t\u1ed3n t\u1ea1i!",overlayClosesOnClick:!1,appendLocation:"#manage-page",callback:function(a){a&&addNewCustomer()}});b=!0;break}if(!b){var b="30 50 70 80 100 111".split(" "),c={username:"",
playtime:0,release_card_day:"",expire_card_day:"",card_quantity:1,reward:"false false false false false false".split(" ")};c.username=a.customerName;c.playtime=a.customerPoint;for(i=0;i<b.length;i++)c.reward[i]="on"==a["customerReward"+b[i]]?"true":"false";swal({padding:30});swal.showLoading();$.get("//api.timezonedb.com/v2/get-time-zone?key=UWMROEOGW3ST&format=json&by=zone&zone=Asia/Ho_Chi_Minh",function(a){var b=new Date(1E3*a.timestamp);a=new Date(1E3*(a.timestamp+5184E3));c.release_card_day=b.getUTCDate()+
"/"+(b.getUTCMonth()+1)+"/"+b.getUTCFullYear();c.expire_card_day=a.getUTCDate()+"/"+(a.getUTCMonth()+1)+"/"+a.getUTCFullYear();$.post("/admin/newUser",c,function(a){swal.hideLoading();swal("Th\u00e0nh c\u00f4ng","\u0110\u00e3 th\u00eam kh\u00e1ch h\u00e0ng!","success");c._id=a;vue.$data.customerList.push(c);vue.$data.customerList.sort(function(a,b){return b.playtime-a.playtime})})})}}}})}
function removeCustomer(a){swal({title:"B\u1ea1n c\u00f3 ch\u1eafc ch\u1eafn?",text:"B\u1ea1n kh\u00f4ng th\u1ec3 ho\u00e0n t\u00e1c khi \u0111\u00e3 th\u1ef1c hi\u1ec7n x\u00f3a !",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"X\u00e1c nh\u1eadn",cancelButtonText:"H\u1ee7y b\u1ecf"}).then(function(){swal({padding:30});swal.showLoading();$.post("/admin/removeUser",{_id:a}).done(function(){swal.hideLoading();swal("Th\u00e0nh c\u00f4ng",
"\u0110\u00e3 x\u00f3a kh\u00e1ch h\u00e0ng!","success");for(i=0;i<vue.$data.customerList.length;i++)if(vue.$data.customerList[i]._id==a){vue.$data.customerList.splice(i,1);break}})})["catch"](swal.noop)}
function updateCustomer(a){var b=!1;for(i=1;i<=$("tbody#vue > tr").length;i++)if("inline-block"==$("tbody#vue > tr:nth-child("+i+") > td:nth-child(7) > a:first-child").css("display")){b=!0;break}if(!b){var b=parseInt($("tr#"+a+" > td:nth-child(2)").text()),d=parseInt($("tr#"+a+" > td:nth-child(5)").text());$("tr#"+a+" > td:nth-child(2) > p").css("display","none");$("tr#"+a+" > td:nth-child(5) > p").css("display","none");$("tr#"+a+" > td:nth-child(2)").append('<input type="number" step="1" value='+
b+' min="1">');$("tr#"+a+" > td:nth-child(5)").append('<input type="number" step="1" value='+d+' min="1">');$("tr#"+a+" > td:nth-child(6) > input").css("cursor","").removeAttr("disabled");$("tr#"+a+" > td:nth-child(7) > a:nth-child(2)").css("display","none");$("tr#"+a+" > td:nth-child(7) > a:nth-child(1)").css("display","inline-block");resizeFixedTableHead()}}
function saveUpdateCustomer(a){for(i=0;i<vue.$data.customerList.length;i++){var b=[];if(a==vue.$data.customerList[i]._id){$("#"+a+" > td:nth-child(6) > input").each(function(a,c){vue.$data.customerList[i].reward[a]==$(c).is(":checked").toString()?b[a]=!0:b[a]=!1});$("tr#"+a+" > td:nth-child(2) > input").val()!=vue.$data.customerList[i].playtime&&""!=$("tr#"+a+" > td:nth-child(2) > input").val()||$("tr#"+a+" > td:nth-child(5) > input").val()!=vue.$data.customerList[i].card_quantity&&""!=$("tr#"+a+
" > td:nth-child(5) > input").val()||1!=b[0]||1!=b[1]||1!=b[2]||1!=b[3]||1!=b[4]||1!=b[5]?(vue.$data.customerList[i].playtime=$("tr#"+a+" > td:nth-child(2) > input").val(),vue.$data.customerList[i].card_quantity=$("tr#"+a+" > td:nth-child(5) > input").val(),$("#"+a+" > td:nth-child(6) > input").each(function(a,b){vue.$data.customerList[i].reward[a]=$(b).is(":checked").toString()}),swal({padding:30}),swal.showLoading(),$.post("/admin/updateUser",vue.$data.customerList[i],function(){swal.hideLoading();
swal("Th\u00e0nh c\u00f4ng","\u0110\u00e3 c\u1eadp nh\u1eadt th\u00e0nh c\u00f4ng th\u00f4ng tin kh\u00e1ch h\u00e0ng!","success");$("tr#"+a+" > td:nth-child(2) > input").remove();$("tr#"+a+" > td:nth-child(5) > input").remove();$("tr#"+a+" > td:nth-child(2) > p").css("display","block");$("tr#"+a+" > td:nth-child(5) > p").css("display","block");$("tr#"+a+" > td:nth-child(7) > a:nth-child(1)").css("display","none");$("tr#"+a+" > td:nth-child(7) > a:nth-child(2)").css("display","inline-block");$("tr#"+
a+" > td:nth-child(6) > input").css("cursor","default").attr("disabled",!0);vue.$data.customerList.sort(function(a,b){return b.playtime-a.playtime});resizeFixedTableHead()})):($("tr#"+a+" > td:nth-child(2) > input").remove(),$("tr#"+a+" > td:nth-child(5) > input").remove(),$("tr#"+a+" > td:nth-child(2) > p").css("display","block"),$("tr#"+a+" > td:nth-child(5) > p").css("display","block"),$("tr#"+a+" > td:nth-child(7) > a:nth-child(1)").css("display","none"),$("tr#"+a+" > td:nth-child(7) > a:nth-child(2)").css("display",
"inline-block"),$("tr#"+a+" > td:nth-child(6) > input").css("cursor","default").attr("disabled",!0),resizeFixedTableHead());break}}}
function checkInput(a){a?""==$("input#username").val()||""==$("input#password").val()?swal("Oops...","Vui l\u00f2ng nh\u1eadp t\u00e0i kho\u1ea3n v\u00e0 m\u1eadt kh\u1ea9u","warning"):($("div#login-page").css("display","none"),$("div.loader-parent").removeAttr("style"),$.post({url:"admin/adminLogin",data:{username:$("input#username").val(),password:$("input#password").val()},success:function(a){a.status?(vue.$data.customerList=cl,vue.$data.customerList.sort(function(a,b){return b.playtime-a.playtime}),
$("div#manage-page").css("visibility","hidden").fadeIn(400,function(){$("input#username").val("");$("input#password").val("");$("#custom-search-input > div > input").height($("#custom-search-input > div > input").height()-4);$("#custom-search-input > div > span > button").height($("#add-new-btn").height()+18);resizeFixedTableHead();$("div.loader-parent").fadeOut(400,function(){$("div#manage-page").css("visibility","");wakeHerokuAppTimer=setInterval(function(){$.post("/admin/wakeHerokuApp")},12E5)})})):
(2==a.code?($("div.loader-parent").css("display","none"),$("div#login-page").css("display",""),swal("Oops...","T\u00e0i kho\u1ea3n ho\u1eb7c m\u1eadt kh\u1ea9u sai!","error")):1==a.code&&($("div.loader-parent").css("display","none"),$("div#login-page").css("display",""),swal("Oops...","T\u00e0i kho\u1ea3n \u0111ang \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng !","error")),glob_submit=!1)},async:!1})):userExecuteMaliciousScript()}
function resizeFixedTableHead(){$("#fixed-thead > tr:nth-child(1) > th").width($("#manage-page > div > div > table > thead:nth-child(2) > tr:nth-child(1) > th").width());for(i=0;7>i;i++)$("#fixed-thead > tr:nth-child(2) > th:nth-child("+i+")").width($("#manage-page > div > div > table > thead:nth-child(2) > tr:nth-child(2) > th:nth-child("+i+")").width())}
function userExecuteMaliciousScript(){swal("WARNING!!!","You are trying to executed malicious script, stop it!!!","error");$("div#manage-page").attr("style","display: none !important")};